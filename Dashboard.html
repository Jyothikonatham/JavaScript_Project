<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard | Expense Tracker</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Particles.js -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

  <link rel="stylesheet" href="./Register.css">
  <style>
    .summary-btn {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(12px);
      border-radius: 1rem;
      padding: 1.5rem;
      font-weight: 600;
      color: #1f2937;
      text-align: center;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease, background 0.2s ease;
    }

    .summary-btn:hover {
      background: rgba(255, 255, 255, 0.95);
      transform: translateY(-3px);
    }

    .input-field {
      width: 100%;
      padding: 0.6rem 1rem;
      border-radius: 0.75rem;
      border: 1px solid #ddd;
      outline: none;
    }

    .submit-btn {
      background: linear-gradient(to right, #6366F1, #8B5CF6);
      color: white;
      font-weight: 600;
      padding: 0.7rem;
      border-radius: 0.75rem;
      width: 100%;
      transition: 0.3s;
    }

    .submit-btn:hover {
      opacity: 0.9;
    }

    #insightContent p {
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeSlideIn {
      0% {
        opacity: 0;
        transform: translateY(-8px);
      }

      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .insight-refresh {
      animation: fadeSlideIn 0.5s ease forwards;
    }
    /* Dropdown panel shadow, rounded and hidden */
#userDropdown {
  transition: all 0.3s ease;
}

/* Tab content */
.tab-content { display: block; }
.tab-content.hidden { display: none; }

/* Hover and focus */
.dropdown-btn:hover { background-color: #6366f1; color: white; }

  </style>
</head>

<body class="bg-gray-100 relative">

  <!-- Particles Background -->
  <div id="particles-js" class="fixed inset-0 z-0"></div>

  <section class="relative z-10 min-h-screen px-6 py-8">

    <!-- Header with Profile -->
    <div class="flex justify-between items-center mb-8">
      <div class="flex items-center space-x-4">
        <div id="profilePicContainer"
          class="w-16 h-16 rounded-full bg-gray-300 cursor-pointer overflow-hidden border-2 border-white">
          <img id="profilePic" src="" alt="Profile" class="w-full h-full object-cover hidden">
          <span id="profilePlaceholder"
            class="w-full h-full flex items-center justify-center text-gray-600 font-bold">+</span>
        </div>
        <h1 class="text-3xl font-bold text-gray-800">Hello, <span id="userName"></span>!</h1>
      </div>
      <div class="relative inline-block" id="userDropdownWrapper">
  <img id="userIcon" src="" alt="User Icon" class="w-12 h-12 rounded-full border-2 border-gray-200 cursor-pointer object-cover">
  <!-- Dropdown Panel -->
  <div id="userDropdown" class="hidden absolute right-0 mt-3 w-60 bg-white rounded-xl shadow-lg z-50 p-4">
    <div class="flex flex-col space-y-2">
      <button class="dropdown-btn w-full text-left px-3 py-2 rounded hover:bg-indigo-500 hover:text-white" data-tab="infoTab">User Info</button>
      <button class="dropdown-btn w-full text-left px-3 py-2 rounded hover:bg-indigo-500 hover:text-white" data-tab="statsTab">Quick Stats</button>
      <button class="dropdown-btn w-full text-left px-3 py-2 rounded hover:bg-indigo-500 hover:text-white" data-tab="settingsTab">Settings</button>
    </div>
    <div id="dropdownContent" class="mt-3">
      <!-- Tab Contents -->
      <div id="infoTab" class="tab-content">
        <p><strong>Name:</strong> <span id="tabUserName">User</span></p>
        <p><strong>Email:</strong> <span id="tabUserEmail">user@example.com</span></p>
        <button id="editProfileBtn" class="w-full mt-2 px-2 py-1 rounded bg-gray-200 hover:bg-indigo-500 hover:text-white">Edit Profile</button>
        <button id="changePicBtn" class="w-full mt-1 px-2 py-1 rounded bg-gray-200 hover:bg-indigo-500 hover:text-white">Change Picture</button>
      </div>
      <div id="statsTab" class="tab-content hidden">
        <p><strong>Total Expenses:</strong> â‚¹<span id="tabTotalExpenses">0</span></p>
        <p><strong>Top Category:</strong> <span id="tabTopCategory">â€”</span></p>
        <p><strong>Last Login:</strong> <span id="tabLastLogin">â€”</span></p>
      </div>
      <div id="settingsTab" class="tab-content hidden">
        <button id="accountSettingsBtn" class="w-full mt-1 px-2 py-1 rounded bg-gray-200 hover:bg-indigo-500 hover:text-white">Account Settings</button>
        <button id="themeToggleBtn" class="w-full mt-1 px-2 py-1 rounded bg-gray-200 hover:bg-indigo-500 hover:text-white">Theme Toggle</button>
        <button id="logoutBtn" class="w-full mt-1 px-2 py-1 rounded bg-red-500 text-white hover:bg-red-600">Logout</button>
      </div>
    </div>
  </div>
</div>
          </div>

    <!-- Summary Buttons -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <button class="summary-btn" id="btnTotal">ğŸ’° Total Expenses</button>
      <button class="summary-btn" id="btnToday">ğŸ“… Today's Spending</button>
      <button class="summary-btn" id="btnMonth">ğŸ—“ï¸ This Month</button>
      <button class="summary-btn" id="btnLast">ğŸ§¾ Recent Expense</button>
    </div>

    <!-- Popup Modal -->
    <div id="popupModal"
      class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
      <div class="bg-white rounded-2xl p-6 w-11/12 sm:w-1/2 lg:w-1/3 shadow-2xl relative animate-fadeIn">
        <button id="closePopup"
          class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-xl font-bold">âœ–</button>
        <h2 id="popupTitle" class="text-2xl font-semibold text-center mb-4 text-gray-900"></h2>
        <div id="popupContent" class="space-y-3 max-h-80 overflow-y-auto text-gray-800"></div>
      </div>
    </div>

    <!-- === Edit Profile Modal === -->
<div id="editProfileModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-2xl shadow-xl w-96 relative">
    <h2 class="text-xl font-semibold mb-4 text-center">Edit Profile</h2>
    <label class="block text-gray-700 font-medium mb-1">Name</label>
    <input id="editName" type="text" class="w-full border rounded-lg px-3 py-2 mb-3 focus:ring-2 focus:ring-indigo-400">

    <label class="block text-gray-700 font-medium mb-1">Email</label>
    <input id="editEmail" type="email" class="w-full border rounded-lg px-3 py-2 mb-3 focus:ring-2 focus:ring-indigo-400">

    <div class="flex justify-end gap-2 mt-4">
      <button id="cancelEditProfile" class="px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400">Cancel</button>
      <button id="saveEditProfile" class="px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">Save</button>
    </div>
  </div>
</div>

    <!-- Search / Filter -->
    <div class="flex flex-col lg:flex-row gap-4 mb-6">
      <input type="text" id="searchExpense" placeholder="Search by title..." class="input-field flex-1">
      <select id="filterCategory" class="input-field w-40">
        <option value="">All Categories</option>
        <option value="Food">ğŸ• Food</option>
        <option value="Shopping">ğŸ’³ Shopping</option>
        <option value="Home">ğŸ  Home</option>
        <option value="Other">ğŸ“ Other</option>
      </select>
      <input type="date" id="filterFrom" class="input-field w-40">
      <input type="date" id="filterTo" class="input-field w-40">
      <button id="clearFilters" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg">Clear</button>
    </div>

    <!-- === Dashboard Main Layout === -->
    <section class="mt-10 grid grid-cols-1 lg:grid-cols-3 gap-8">

      <!-- LEFT SIDE (Add Expense Form + Recent Expenses) -->
      <div class="lg:col-span-2 bg-white/90 backdrop-blur-xl rounded-2xl p-6 shadow-xl">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">â• Add Expense</h2>

        <!-- Add Expense Form -->
        <form id="expenseForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
          <div>
            <label for="title" class="block text-gray-700 font-medium mb-1">Title</label>
            <input id="title" type="text"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400"
              placeholder="e.g. Groceries" required />
          </div>
          <div>
            <label for="amount" class="block text-gray-700 font-medium mb-1">Amount (â‚¹)</label>
            <input id="amount" type="number" min="1"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400"
              placeholder="e.g. 500" required />
          </div>
          <div>
            <label for="category" class="block text-gray-700 font-medium mb-1">Category</label>
            <select id="category"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400" required>
              <option value="">Select Category</option>
              <option value="Food">ğŸ” Food & Dining</option>
              <option value="Shopping">ğŸ›ï¸ Shopping</option>
              <option value="Travel">âœˆï¸ Travel</option>
              <option value="Groceries">ğŸ›’ Groceries</option>
              <option value="Entertainment">ğŸ¬ Entertainment</option>
              <option value="Bills">ğŸ’¡ Bills & Utilities</option>
              <option value="Health">ğŸ’Š Health & Fitness</option>
              <option value="Education">ğŸ“š Education</option>
              <option value="Transport">ğŸš— Transport</option>
              <option value="Subscriptions">ğŸ’» Subscriptions</option>
              <option value="Other">ğŸ“ Other</option>
              <option>Other</option>
            </select>
          </div>
          <div>
            <label for="date" class="block text-gray-700 font-medium mb-1">Date</label>
            <input id="date" type="date"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400" required />
          </div>

          <div class="md:col-span-2">
            <button type="submit"
              class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 rounded-lg transition-all">
              Add Expense
            </button>
          </div>
        </form>

        <!-- Recent Expenses -->
        <div id="recentExpenses" class="mt-4 border-t border-gray-300 pt-4">
          <h3 class="text-lg font-semibold text-gray-700 mb-3">ğŸ§¾ Recent Expenses</h3>
          <ul id="recentList" class="space-y-2 text-gray-700 text-sm"></ul>
        </div>

        <!-- Download & Share -->
        <div class="flex justify-end gap-3 mt-6">
          <button id="downloadCsv" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm">ğŸ“¥
            Download CSV</button>
          <button id="shareSummary" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">ğŸ”—
            Share Summary</button>
        </div>
      </div>

      <!-- RIGHT SIDE (Smart Insights) -->
      <div
        class="bg-gradient-to-br from-indigo-100 via-white to-purple-100 rounded-2xl shadow-xl p-6 flex flex-col justify-between">
        <div>
          <h2 class="text-2xl font-bold mb-6 text-indigo-700 text-center">ğŸ’¡ Smart Insights</h2>

          <div id="insightContent" class="space-y-4 text-gray-800 text-base">
            <p>ğŸ¥‡ <strong>Top Category:</strong> <span id="insightTopCat">â€”</span></p>
            <p>ğŸ“ˆ <strong>Highest Expense:</strong> <span id="insightHighExp">â€”</span></p>
            <p>ğŸ“… <strong>Most Active Day:</strong> <span id="insightActiveDay">â€”</span></p>
            <p>â³ <strong>Avg Daily Spend:</strong> <span id="insightAvgSpend">â€”</span></p>
            <p id="insightAlert" class="text-red-500 font-semibold mt-2 hidden">âš ï¸ Overspend Alert: Over â‚¹10,000!</p>
          </div>
        </div>

        <div class="border-t border-gray-300 mt-6 pt-4 text-center">
          <p class="text-gray-500 text-sm">Auto updates with every new expense ğŸ’¸</p>
        </div>
      </div>
    </section>
    <!-- Charts Section -->
     <br>
    <h2 class="text-2xl font-semibold text-center mb-6 text-gray-800">Your Spending Insights</h2>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg">
        <h2 class="text-xl font-semibold mb-4 text-gray-900 text-center">Spending by Category</h2>
        <canvas id="categoryChart"></canvas>
      </div>
      <div class="bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg">
        <h2 class="text-xl font-semibold mb-4 text-gray-900 text-center">Spending Over Time</h2>
        <canvas id="timeChart"></canvas>
      </div>
    </div>

    <!-- Quick Add Floating Button -->
    <button id="quickAddBtn"
      class="fixed bottom-6 right-6 w-14 h-14 rounded-full bg-yellow-400 text-white text-3xl shadow-lg hover:bg-yellow-500 transition">+</button>

  </section>

  <script src="./Dashboard.js"></script>
</body>

</html>